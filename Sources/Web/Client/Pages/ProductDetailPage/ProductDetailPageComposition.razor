@using Domain.Models
@using Utils

@inherits PageComponentBase

<MudCard>
    <MudCardHeader>
        <MudText Typo="Typo.h5">Composition</MudText>
    </MudCardHeader>
    <MudCardContent>
        <MudTable Items="@ProductDetail.ProductMaterial" Dense="true" Striped="true">
            <HeaderContent>
                <MudTh>Référence</MudTh>
                <MudTh>Nom</MudTh>
                <MudTh>Coût</MudTh>
                <MudTh>Quantité</MudTh>
                <MudTh>Type</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Référence">@context.Material.Reference</MudTd>
                <MudTd DataLabel="Nom">@context.Material.Name</MudTd>
                <MudTd DataLabel="Coût">
                    <MudNumericField Variant="Variant.Text" Adornment="Adornment.End" AdornmentText="€" AdornmentColor="Color.Info" Margin="Margin.Dense"
                                  Style="width:85px; margin:0;" ValueChanged="@((e) => CostChanged(e, context.Id))" T=double Value=@context.Cost />
                </MudTd>
                <MudTd DataLabel="Quantité">
                    <MudNumericField Variant="Variant.Text" Adornment="Adornment.End" AdornmentText="g" AdornmentColor="Color.Info" Margin="Margin.Dense"
                                  Style="width:85px; margin:0;" ValueChanged="@((e) => QuantityChanged(e, context.Id))" T=double Value=@context.Quantity />
                </MudTd>
                <MudTd DataLabel="Type">@context.Material.Type</MudTd>
            </RowTemplate>
        </MudTable>
        <MudAutocomplete @ref="AutocompleteBox" Class="ma-5" T="Material" Label="Mat." ToStringFunc="@(e=> e==null?null : $"{e.Reference} - {e.Name}")" SearchFunc="@Search1"
                         ResetValueOnEmptyText="true" ValueChanged=SelectedValueChanged />

    </MudCardContent>
</MudCard>